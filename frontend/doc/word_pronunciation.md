**ä¸­æ–‡** | [English](word_pronunciation_en.md)

# å•è¯å‘éŸ³æ’­æ”¾æ–¹æ¡ˆ

> ğŸ“‹ **åŠŸèƒ½è¯´æ˜**: åœ¨å‘éŸ³åé¦ˆé¡µé¢ï¼Œç”¨æˆ·ç‚¹å‡»ä»»æ„å•è¯æ—¶ï¼Œæ’­æ”¾è¯¥å•è¯çš„æ­£ç¡®å‘éŸ³ã€‚

## ğŸ¯ è®¾è®¡ç›®æ ‡

- âœ… ä½å»¶è¿Ÿï¼šç”¨æˆ·ç‚¹å‡»åå¿«é€Ÿå“åº”
- âœ… å¤šè¯­è¨€ï¼šæ”¯æŒè‹±è¯­ã€ä¸­æ–‡ã€æ—¥è¯­ã€éŸ©è¯­ç­‰å¤šç§è¯­è¨€
- âœ… é«˜è´¨é‡ï¼šå‘éŸ³å‡†ç¡®ï¼Œä¸è¯„ä¼°æ ‡å‡†ä¸€è‡´
- âœ… æˆæœ¬å¯æ§ï¼šé€šè¿‡ç¼“å­˜å‡å°‘ API è°ƒç”¨

---

## ğŸ“ æ··åˆæ–¹æ¡ˆæ¶æ„

```
ç”¨æˆ·ç‚¹å‡»å•è¯
    â†“
[1. æ£€æŸ¥æœ¬åœ°ç¼“å­˜] â”€â”€â”€(æœ‰)â”€â”€â†’ ç›´æ¥æ’­æ”¾ âœ…
    â†“ (æ— )
[2. æ£€æŸ¥è¯­è¨€æ˜¯å¦æœ¬åœ° TTS æ”¯æŒ]
    â†“
  â”Œâ”€(æ”¯æŒ)â”€â”€â”€â”€â†’ [3a] æœ¬åœ° TTS æ’­æ”¾ âœ…ï¼ˆé›¶æˆæœ¬ï¼‰
  â”‚
  â””â”€(ä¸æ”¯æŒ)â”€â”€â†’ [3b] è¯·æ±‚äº‘ç«¯ TTS â†’ æ’­æ”¾ â†’ ç¼“å­˜
```

---

## ğŸ”€ äº‘ç«¯ TTS æœåŠ¡é€‰å‹

> âš ï¸ **å¾…å†³ç­–**ï¼šä»¥ä¸‹ä¸¤ä¸ªæœåŠ¡å‡å¯ä½¿ç”¨ï¼Œéœ€æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©ã€‚

### æ–¹æ¡ˆ A: MiniMax TTSï¼ˆå·²é›†æˆï¼‰

| ç»´åº¦       | è¯´æ˜                                |
| ---------- | ----------------------------------- |
| **çŠ¶æ€**   | âœ… å·²é›†æˆï¼Œ`/tts/generate` ç«¯ç‚¹å¯ç”¨ |
| **å¤šè¯­è¨€** | âš ï¸ ä¸»è¦ä¼˜åŒ–ä¸­æ–‡ï¼Œè‹±è¯­è´¨é‡ä¸€èˆ¬       |
| **å»¶è¿Ÿ**   | æµå¼å“åº”ï¼Œé¦–å­—èŠ‚è¾ƒå¿«                |
| **ä¼˜åŠ¿**   | æ— éœ€é¢å¤–å¼€å‘ï¼Œå¤ç”¨ç°æœ‰æœåŠ¡          |
| **åŠ£åŠ¿**   | å•ä»·è¾ƒé«˜ï¼Œéä¸­æ–‡è¯­è¨€è´¨é‡ä¸ç¡®å®š      |

### æ–¹æ¡ˆ B: Azure Speech TTSï¼ˆéœ€æ–°å¢ï¼‰

| ç»´åº¦       | è¯´æ˜                                         |
| ---------- | -------------------------------------------- |
| **çŠ¶æ€**   | âš ï¸ éœ€æ–°å¢é›†æˆï¼ˆå·²æœ‰ Azure è´¦å·ç”¨äºå‘éŸ³è¯„ä¼°ï¼‰ |
| **å¤šè¯­è¨€** | âœ… 140+ è¯­è¨€ï¼Œ400+ ç¥ç»è¯­éŸ³                  |
| **å»¶è¿Ÿ**   | ~100-200ms                                   |
| **ä¼˜åŠ¿**   | å¤šè¯­è¨€è´¨é‡ç¨³å®šï¼Œä¸å‘éŸ³è¯„ä¼°æœåŠ¡ç»Ÿä¸€           |
| **åŠ£åŠ¿**   | éœ€é¢å¤–å¼€å‘                                   |

### å¯¹æ¯”æ€»ç»“

| ç»´åº¦       | MiniMax         | Azure                           |
| ---------- | --------------- | ------------------------------- |
| å¼€å‘æˆæœ¬   | ğŸŸ¢ ä½ï¼ˆå·²é›†æˆï¼‰ | ğŸŸ¡ ä¸­ï¼ˆéœ€æ–°å¢ï¼‰                 |
| å•ä»·       | ğŸŸ¡ Â¥3.5/ä¸‡å­—ç¬¦  | ğŸŸ¢ $15/ç™¾ä¸‡å­—ç¬¦ (â‰ˆÂ¥1.08/ä¸‡å­—ç¬¦) |
| ä¸­æ–‡è´¨é‡   | ğŸŸ¢ ä¼˜ç§€         | ğŸŸ¢ ä¼˜ç§€                         |
| è‹±è¯­è´¨é‡   | ğŸŸ¡ ä¸€èˆ¬         | ğŸŸ¢ ä¼˜ç§€                         |
| å¤šè¯­è¨€æ”¯æŒ | ğŸŸ¡ æœ‰é™         | ğŸŸ¢ 140+ è¯­è¨€                    |

---

## ğŸ’° æˆæœ¬ä¼°ç®—

### åŸºç¡€å‡è®¾

- å•è¯å¹³å‡é•¿åº¦ï¼š7 å­—ç¬¦
- ç”¨æˆ·æ¯å¤©ç»ƒä¹ ï¼š100 ä¸ªå•è¯
- æœˆæ´»è·ƒç”¨æˆ·ï¼š1000 DAU

### MiniMax TTS æˆæœ¬

| åœºæ™¯                     | è®¡ç®—               | æˆæœ¬ (RMB)    |
| ------------------------ | ------------------ | ------------- |
| å•ä»·                     | Â¥3.5 / ä¸‡å­—ç¬¦      | -             |
| æ¯æ¬¡å•è¯ TTS             | 7 Ã— Â¥0.00035       | Â¥0.00245      |
| ç”¨æˆ·æ¯å¤© 100 è¯          | 100 Ã— Â¥0.00245     | Â¥0.245        |
| 1000 DAU / æœˆ (æ— ç¼“å­˜)   | 1000 Ã— 30 Ã— Â¥0.245 | **Â¥7,350/æœˆ** |
| 1000 DAU / æœˆ (90% ç¼“å­˜) | Â¥7,350 Ã— 10%       | **Â¥735/æœˆ**   |

### Azure TTS æˆæœ¬

| åœºæ™¯                     | è®¡ç®—                | æˆæœ¬                  |
| ------------------------ | ------------------- | --------------------- |
| å•ä»·                     | $15 / ç™¾ä¸‡å­—ç¬¦      | -                     |
| æ¯æ¬¡å•è¯ TTS             | 7 Ã— $0.000015       | $0.000105             |
| ç”¨æˆ·æ¯å¤© 100 è¯          | 100 Ã— $0.000105     | $0.0105               |
| 1000 DAU / æœˆ (æ— ç¼“å­˜)   | 1000 Ã— 30 Ã— $0.0105 | **$315/æœˆ (â‰ˆÂ¥2,268)** |
| 1000 DAU / æœˆ (90% ç¼“å­˜) | $315 Ã— 10%          | **$31.5/æœˆ (â‰ˆÂ¥227)**  |

### OpenAI TTS æˆæœ¬

#### TTS-1 (æ ‡å‡†ç‰ˆ)

| åœºæ™¯                     | è®¡ç®—                | æˆæœ¬                  |
| ------------------------ | ------------------- | --------------------- |
| å•ä»·                     | $15 / ç™¾ä¸‡å­—ç¬¦      | -                     |
| æ¯æ¬¡å•è¯ TTS             | 7 Ã— $0.000015       | $0.000105             |
| ç”¨æˆ·æ¯å¤© 100 è¯          | 100 Ã— $0.000105     | $0.0105               |
| 1000 DAU / æœˆ (æ— ç¼“å­˜)   | 1000 Ã— 30 Ã— $0.0105 | **$315/æœˆ (â‰ˆÂ¥2,268)** |
| 1000 DAU / æœˆ (90% ç¼“å­˜) | $315 Ã— 10%          | **$31.5/æœˆ (â‰ˆÂ¥227)**  |

#### TTS-1-HD (é«˜æ¸…ç‰ˆ)

| åœºæ™¯                     | è®¡ç®—               | æˆæœ¬                  |
| ------------------------ | ------------------ | --------------------- |
| å•ä»·                     | $30 / ç™¾ä¸‡å­—ç¬¦     | -                     |
| æ¯æ¬¡å•è¯ TTS             | 7 Ã— $0.00003       | $0.00021              |
| ç”¨æˆ·æ¯å¤© 100 è¯          | 100 Ã— $0.00021     | $0.021                |
| 1000 DAU / æœˆ (æ— ç¼“å­˜)   | 1000 Ã— 30 Ã— $0.021 | **$630/æœˆ (â‰ˆÂ¥4,536)** |
| 1000 DAU / æœˆ (90% ç¼“å­˜) | $630 Ã— 10%         | **$63/æœˆ (â‰ˆÂ¥454)**    |

### ElevenLabs æˆæœ¬

> âš ï¸ ElevenLabs é‡‡ç”¨è®¢é˜…åˆ¶ï¼ŒæŒ‰é‡æŠ˜ç®—çº¦ $100-300/ç™¾ä¸‡å­—ç¬¦ï¼Œä»¥ä¸‹æŒ‰ $150/ç™¾ä¸‡å­—ç¬¦ ä¼°ç®—ã€‚

| åœºæ™¯                     | è®¡ç®—               | æˆæœ¬                    |
| ------------------------ | ------------------ | ----------------------- |
| å•ä»· (ä¼°ç®—)              | ~$150 / ç™¾ä¸‡å­—ç¬¦   | -                       |
| æ¯æ¬¡å•è¯ TTS             | 7 Ã— $0.00015       | $0.00105                |
| ç”¨æˆ·æ¯å¤© 100 è¯          | 100 Ã— $0.00105     | $0.105                  |
| 1000 DAU / æœˆ (æ— ç¼“å­˜)   | 1000 Ã— 30 Ã— $0.105 | **$3,150/æœˆ (â‰ˆÂ¥22,680)**|
| 1000 DAU / æœˆ (90% ç¼“å­˜) | $3,150 Ã— 10%       | **$315/æœˆ (â‰ˆÂ¥2,268)**   |

### Google Cloud TTS æˆæœ¬

#### Standard (æ ‡å‡†ç‰ˆ)

| åœºæ™¯                     | è®¡ç®—                | æˆæœ¬                |
| ------------------------ | ------------------- | ------------------- |
| å•ä»·                     | $4 / ç™¾ä¸‡å­—ç¬¦       | -                   |
| æ¯æ¬¡å•è¯ TTS             | 7 Ã— $0.000004       | $0.000028           |
| ç”¨æˆ·æ¯å¤© 100 è¯          | 100 Ã— $0.000028     | $0.0028             |
| 1000 DAU / æœˆ (æ— ç¼“å­˜)   | 1000 Ã— 30 Ã— $0.0028 | **$84/æœˆ (â‰ˆÂ¥605)**  |
| 1000 DAU / æœˆ (90% ç¼“å­˜) | $84 Ã— 10%           | **$8.4/æœˆ (â‰ˆÂ¥60)**  |

> ğŸ’¡ å…è´¹é¢åº¦ï¼šWaveNet/Neural2 æ¯æœˆå‰ 100 ä¸‡å­—ç¬¦å…è´¹ï¼Œå¯è¦†ç›–çº¦ 143,000 æ¬¡å•è¯æ’­æ”¾ã€‚

#### WaveNet / Neural2 (é«˜è´¨é‡ç‰ˆ)

| åœºæ™¯                     | è®¡ç®—                 | æˆæœ¬                  |
| ------------------------ | -------------------- | --------------------- |
| å•ä»·                     | $16 / ç™¾ä¸‡å­—ç¬¦       | -                     |
| æ¯æ¬¡å•è¯ TTS             | 7 Ã— $0.000016        | $0.000112             |
| ç”¨æˆ·æ¯å¤© 100 è¯          | 100 Ã— $0.000112      | $0.0112               |
| 1000 DAU / æœˆ (æ— ç¼“å­˜)   | 1000 Ã— 30 Ã— $0.0112  | **$336/æœˆ (â‰ˆÂ¥2,419)** |
| 1000 DAU / æœˆ (90% ç¼“å­˜) | $336 Ã— 10%           | **$33.6/æœˆ (â‰ˆÂ¥242)**  |

### Amazon Polly æˆæœ¬

#### Standard (æ ‡å‡†ç‰ˆ)

| åœºæ™¯                     | è®¡ç®—                | æˆæœ¬                |
| ------------------------ | ------------------- | ------------------- |
| å•ä»·                     | $4 / ç™¾ä¸‡å­—ç¬¦       | -                   |
| æ¯æ¬¡å•è¯ TTS             | 7 Ã— $0.000004       | $0.000028           |
| ç”¨æˆ·æ¯å¤© 100 è¯          | 100 Ã— $0.000028     | $0.0028             |
| 1000 DAU / æœˆ (æ— ç¼“å­˜)   | 1000 Ã— 30 Ã— $0.0028 | **$84/æœˆ (â‰ˆÂ¥605)**  |
| 1000 DAU / æœˆ (90% ç¼“å­˜) | $84 Ã— 10%           | **$8.4/æœˆ (â‰ˆÂ¥60)**  |

#### Neural (ç¥ç»ç½‘ç»œç‰ˆ)

| åœºæ™¯                     | è®¡ç®—                 | æˆæœ¬                  |
| ------------------------ | -------------------- | --------------------- |
| å•ä»·                     | $16 / ç™¾ä¸‡å­—ç¬¦       | -                     |
| æ¯æ¬¡å•è¯ TTS             | 7 Ã— $0.000016        | $0.000112             |
| ç”¨æˆ·æ¯å¤© 100 è¯          | 100 Ã— $0.000112      | $0.0112               |
| 1000 DAU / æœˆ (æ— ç¼“å­˜)   | 1000 Ã— 30 Ã— $0.0112  | **$336/æœˆ (â‰ˆÂ¥2,419)** |
| 1000 DAU / æœˆ (90% ç¼“å­˜) | $336 Ã— 10%           | **$33.6/æœˆ (â‰ˆÂ¥242)**  |

> ğŸ’¡ å…è´¹é¢åº¦ï¼šNeural å¼•æ“é¦–å¹´æ¯æœˆ 100 ä¸‡å­—ç¬¦å…è´¹ã€‚

#### Generative (ç”Ÿæˆå¼)

| åœºæ™¯                     | è®¡ç®—               | æˆæœ¬                  |
| ------------------------ | ------------------ | --------------------- |
| å•ä»·                     | $30 / ç™¾ä¸‡å­—ç¬¦     | -                     |
| æ¯æ¬¡å•è¯ TTS             | 7 Ã— $0.00003       | $0.00021              |
| ç”¨æˆ·æ¯å¤© 100 è¯          | 100 Ã— $0.00021     | $0.021                |
| 1000 DAU / æœˆ (æ— ç¼“å­˜)   | 1000 Ã— 30 Ã— $0.021 | **$630/æœˆ (â‰ˆÂ¥4,536)** |
| 1000 DAU / æœˆ (90% ç¼“å­˜) | $630 Ã— 10%         | **$63/æœˆ (â‰ˆÂ¥454)**    |

### æˆæœ¬å¯¹æ¯”

| æœåŠ¡                     | å•ä»· (ç™¾ä¸‡å­—ç¬¦) | æ— ç¼“å­˜ (Â¥/æœˆ) | 90% ç¼“å­˜ (Â¥/æœˆ) | è´¨é‡è¯„ä»·       |
| ------------------------ | --------------- | ------------- | --------------- | -------------- |
| Google/AWS Standard      | $4              | Â¥605          | Â¥60             | ğŸŸ¡ æœºæ¢°        |
| Azure Neural             | $15             | Â¥2,268        | Â¥227            | ğŸŸ¢ ä¼˜ç§€        |
| OpenAI TTS-1             | $15             | Â¥2,268        | Â¥227            | ğŸŸ¢ ä¼˜ç§€        |
| Google WaveNet/Neural2   | $16             | Â¥2,419        | Â¥242            | ğŸŸ¢ ä¼˜ç§€        |
| AWS Polly Neural         | $16             | Â¥2,419        | Â¥242            | ğŸŸ¢ ä¼˜ç§€        |
| OpenAI TTS-1-HD          | $30             | Â¥4,536        | Â¥454            | ğŸŸ¢ é«˜æ¸…        |
| AWS Polly Generative     | $30             | Â¥4,536        | Â¥454            | ğŸŸ¢ é«˜æ¸…        |
| MiniMax                  | Â¥3.5/ä¸‡ (~$49)  | Â¥7,350        | Â¥735            | ğŸŸ¢ ä¸­æ–‡ä¼˜ç§€    |
| ElevenLabs (~$150)       | ~$150           | Â¥22,680       | Â¥2,268          | ğŸŸ¢ å£°éŸ³å…‹éš†å¼º  |

> ğŸ’¡ **ç¼“å­˜ç­–ç•¥è‡³å…³é‡è¦**ï¼šæ— è®ºé€‰æ‹©å“ªä¸ªæœåŠ¡ï¼Œ90% ç¼“å­˜å‘½ä¸­ç‡å¯é™ä½ 90% æˆæœ¬ã€‚
>
> ğŸ“Š **æ¨èé€‰æ‹©**ï¼š
> - **æ€§ä»·æ¯”é¦–é€‰**ï¼šGoogle Cloud Standard æˆ– AWS Polly Standardï¼ˆæœ€ä¾¿å®œï¼Œä½†è´¨é‡ä¸€èˆ¬ï¼‰
> - **è´¨é‡ä¸æˆæœ¬å¹³è¡¡**ï¼šAzure Neural / OpenAI TTS-1 / Google WaveNetï¼ˆ$15-16/ç™¾ä¸‡å­—ç¬¦ï¼‰
> - **ä¸­æ–‡åœºæ™¯**ï¼šMiniMaxï¼ˆå·²é›†æˆï¼Œä¸­æ–‡è´¨é‡ä¼˜ç§€ï¼‰
> - **å£°éŸ³å…‹éš†éœ€æ±‚**ï¼šElevenLabsï¼ˆæœ€è´µï¼Œä½†åŠŸèƒ½æœ€å¼ºå¤§ï¼‰

---

## ğŸ“ å®ç°æ­¥éª¤æ¸…å•

### Phase 1: åç«¯ API

- [ ] **1.1** æ–°å¢ `/tts/word` ç«¯ç‚¹ï¼ˆå¤ç”¨ç°æœ‰ TTS æœåŠ¡æˆ–æ–°å¢ Azureï¼‰
- [ ] **1.2** æ”¯æŒå¤šè¯­è¨€å‚æ•°ï¼ˆlanguage, voiceï¼‰
- [ ] **1.3** è¿”å› MP3 éŸ³é¢‘æ•°æ®ï¼ˆbase64 æˆ– binaryï¼‰
- [ ] **1.4** æ·»åŠ  API æµ‹è¯•ç”¨ä¾‹

### Phase 2: å‰ç«¯åŸºç¡€

- [ ] **2.1** æ·»åŠ  `flutter_tts` ä¾èµ–
- [ ] **2.2** åˆ›å»º `WordTtsService` æœåŠ¡ç±»
- [ ] **2.3** å®ç°æœ¬åœ° TTS æ’­æ”¾åŠŸèƒ½
- [ ] **2.4** å®ç°è¯­è¨€æ”¯æŒæ£€æµ‹ï¼ˆ`getLanguages()`ï¼‰

### Phase 3: ç¼“å­˜å±‚

- [ ] **3.1** è®¾è®¡å•è¯éŸ³é¢‘ç¼“å­˜ç»“æ„
- [ ] **3.2** å®ç°å†…å­˜ç¼“å­˜ï¼ˆLRUï¼‰
- [ ] **3.3** å®ç°ç£ç›˜ç¼“å­˜ï¼ˆæŒä¹…åŒ–ï¼‰
- [ ] **3.4** ç¼“å­˜è¿‡æœŸç­–ç•¥

### Phase 4: æ··åˆç­–ç•¥

- [ ] **4.1** å®ç°ç¼“å­˜ä¼˜å…ˆæ£€æŸ¥
- [ ] **4.2** å®ç°æœ¬åœ° TTS fallback
- [ ] **4.3** å®ç°äº‘ç«¯ TTS è¯·æ±‚ + åå°ç¼“å­˜
- [ ] **4.4** é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

### Phase 5: UI é›†æˆ

- [ ] **5.1** åœ¨ `VoiceFeedbackSheet` ä¸­æ·»åŠ å•è¯ç‚¹å‡»äº‹ä»¶
- [ ] **5.2** æ·»åŠ æ’­æ”¾çŠ¶æ€æŒ‡ç¤ºï¼ˆloading/playingï¼‰
- [ ] **5.3** æ·»åŠ æ’­æ”¾åŠ¨ç”»æ•ˆæœ
- [ ] **5.4** å¤„ç†è¿ç»­å¿«é€Ÿç‚¹å‡»

### Phase 6: æµ‹è¯•ä¸ä¼˜åŒ–

- [ ] **6.1** å•å…ƒæµ‹è¯•
- [ ] **6.2** é›†æˆæµ‹è¯•
- [ ] **6.3** æ€§èƒ½æµ‹è¯•ï¼ˆå»¶è¿Ÿã€ç¼“å­˜å‘½ä¸­ç‡ï¼‰
- [ ] **6.4** å¤šè¯­è¨€æµ‹è¯•

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### åç«¯ API è®¾è®¡

```
POST /tts/word
Content-Type: application/json

Request:
{
  "word": "pineapple",
  "language": "en-US",
  "voice": "..."  // å¯é€‰ï¼ŒæœåŠ¡ç«¯æœ‰é»˜è®¤å€¼
}

Response:
{
  "audio_base64": "//uQxAAAAAANIAAAAAE...",
  "format": "mp3",      // è§ä¸‹æ–¹è¯´æ˜
  "duration_ms": 850    // å¯é€‰
}
```

> âš ï¸ **éŸ³é¢‘æ ¼å¼è¯´æ˜**ï¼š
>
> | æœåŠ¡    | é»˜è®¤æ ¼å¼ | å¤‡æ³¨                                   |
> | ------- | -------- | -------------------------------------- |
> | MiniMax | MP3      | ç°æœ‰é…ç½® `audio_setting.format: "mp3"` |
> | Azure   | å¯é…ç½®   | æ”¯æŒ MP3ã€WAVã€OGG ç­‰ï¼Œå®ç°æ—¶ç¡®è®¤      |
>
> å®ç°æ—¶æ ¹æ®å®é™…é€‰ç”¨çš„æœåŠ¡è°ƒæ•´ `format` å­—æ®µã€‚å‰ç«¯æ’­æ”¾å™¨éœ€å…¼å®¹å¯¹åº”æ ¼å¼ã€‚

### å¤šè¯­è¨€é…ç½®

```dart
class LanguageConfig {
  final String minimaxVoice;  // MiniMax voice ID
  final String azureVoice;    // Azure voice ID
  final String localTtsLocale;
  final String displayName;
}

const Map<String, LanguageConfig> languageConfigs = {
  'en-US': LanguageConfig(
    minimaxVoice: 'English_Trustworthy_Man',
    azureVoice: 'en-US-JennyNeural',
    localTtsLocale: 'en-US',
    displayName: 'English (US)',
  ),
  'en-GB': LanguageConfig(
    minimaxVoice: 'English_Trustworthy_Man',
    azureVoice: 'en-GB-SoniaNeural',
    localTtsLocale: 'en-GB',
    displayName: 'English (UK)',
  ),
  'zh-CN': LanguageConfig(
    minimaxVoice: 'female-tianmei',
    azureVoice: 'zh-CN-XiaoxiaoNeural',
    localTtsLocale: 'zh-CN',
    displayName: 'ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰',
  ),
  'ja-JP': LanguageConfig(
    minimaxVoice: 'Japanese_IntellectualFemale',
    azureVoice: 'ja-JP-NanamiNeural',
    localTtsLocale: 'ja-JP',
    displayName: 'æ—¥æœ¬èª',
  ),
  'ko-KR': LanguageConfig(
    minimaxVoice: 'Korean_IntellectualFemale',
    azureVoice: 'ko-KR-SunHiNeural',
    localTtsLocale: 'ko-KR',
    displayName: 'í•œêµ­ì–´',
  ),
  // æ‰©å±•æ›´å¤šè¯­è¨€...
};
```

### ç¼“å­˜ç»“æ„

```
ğŸ“ app_documents/
â””â”€â”€ ğŸ“ word_tts_cache/
    â””â”€â”€ ğŸ“ {language}/
        â”œâ”€â”€ {encoded_word}.{format}
        â””â”€â”€ ...
```

> ğŸ’¡ ç¼“å­˜æŒ‰è¯­è¨€åˆ†ç›®å½•ï¼Œä¸æŒ‰ç”¨æˆ·åˆ†ã€‚åŒä¸€å•è¯çš„å‘éŸ³å¯¹æ‰€æœ‰ç”¨æˆ·ä¸€è‡´ã€‚

#### æ–‡ä»¶å‘½åè§„åˆ™

ç”±äºä¸åŒè¯­è¨€å¯èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆä¸­æ–‡ã€æ—¥è¯­ã€éŸ©è¯­ã€æ’‡å·ã€è¿å­—ç¬¦ç­‰ï¼‰ï¼Œæ–‡ä»¶åéœ€è¦ç¼–ç å¤„ç†ï¼š

| æ–¹æ¡ˆ              | ç¤ºä¾‹                                      | ä¼˜ç¼ºç‚¹                           |
| ----------------- | ----------------------------------------- | -------------------------------- |
| URL ç¼–ç           | `pineapple.mp3`, `%E4%BD%A0%E5%A5%BD.mp3` | âš ï¸ å¤§å°å†™é—®é¢˜ï¼Œé•¿åº¦å¯èƒ½è¶…é™      |
| **Hash (MD5)** âœ… | `a1b2c3d4e5f6.mp3`                        | âœ… é•¿åº¦å›ºå®šï¼Œæ— ç‰¹æ®Šå­—ç¬¦          |
| Base64            | `cGluZWFwcGxl.mp3`                        | âš ï¸ å¯èƒ½è¾ƒé•¿ï¼Œå« `/` `+` ç‰¹æ®Šå­—ç¬¦ |

> ğŸ“ **å»ºè®®**ï¼šä½¿ç”¨ Hashï¼ˆMD5ï¼‰æ–¹æ¡ˆï¼Œé…åˆå…ƒæ•°æ®æ–‡ä»¶æ”¯æŒè°ƒè¯•ã€‚

#### å‘½åå¤„ç†æµç¨‹

```
åŸå§‹å•è¯ â†’ ç»Ÿä¸€è½¬å°å†™ â†’ MD5 Hash â†’ æ–‡ä»¶å
```

ç¤ºä¾‹ï¼š
| åŸå§‹å•è¯ | è½¬å°å†™ | MD5 Hash | æ–‡ä»¶å |
|----------|--------|----------|--------|
| `Hello` | `hello` | `5d41402abc4b2a76...` | `5d41402abc4b2a76.mp3` |
| `hello` | `hello` | `5d41402abc4b2a76...` | `5d41402abc4b2a76.mp3` |
| `ä½ å¥½` | `ä½ å¥½` | `7eca689f0d3389d9...` | `7eca689f0d3389d9.mp3` |

> ğŸ’¡ **å¤§å°å†™å¤„ç†**ï¼šç»Ÿä¸€è½¬å°å†™åå† hashï¼Œç¡®ä¿ `Hello` å’Œ `hello` å‘½ä¸­åŒä¸€ç¼“å­˜ã€‚

#### å…ƒæ•°æ®æ–‡ä»¶ï¼ˆè°ƒè¯•ç”¨ï¼‰

ä¸ºä¾¿äºè°ƒè¯•ï¼Œæ¯ä¸ªè¯­è¨€ç›®å½•ä¸‹ç»´æŠ¤ä¸€ä¸ª `_metadata.json` æ–‡ä»¶ï¼š

```json
{
  "5d41402abc4b2a76": {
    "word": "hello",
    "format": "mp3",
    "createdAt": "2026-01-16T10:30:00Z",
    "source": "minimax"
  },
  "7eca689f0d3389d9": {
    "word": "ä½ å¥½",
    "format": "mp3",
    "createdAt": "2026-01-16T10:31:00Z",
    "source": "minimax"
  }
}
```

ç¼“å­˜ç›®å½•ç»“æ„ï¼š

```
ğŸ“ word_tts_cache/
â””â”€â”€ ğŸ“ en-US/
    â”œâ”€â”€ _metadata.json
    â”œâ”€â”€ 5d41402abc4b2a76.mp3
    â””â”€â”€ ...
â””â”€â”€ ğŸ“ zh-CN/
    â”œâ”€â”€ _metadata.json
    â”œâ”€â”€ 7eca689f0d3389d9.mp3
    â””â”€â”€ ...
```

#### ç¼“å­˜æŸ¥è¯¢è§„åˆ™

**æŸ¥è¯¢æ—¶åº”å¿½ç•¥æ–‡ä»¶æ‰©å±•å**ï¼Œä»¥æ”¯æŒæ ¼å¼å˜æ›´ï¼š

```dart
import 'package:crypto/crypto.dart';
import 'dart:convert';

// ç”Ÿæˆç¼“å­˜ keyï¼ˆç»Ÿä¸€å°å†™ + MD5ï¼‰
String getCacheKey(String word) {
  final normalized = word.toLowerCase();
  final bytes = utf8.encode(normalized);
  final hash = md5.convert(bytes).toString();
  return hash.substring(0, 16);  // å–å‰ 16 ä½è¶³å¤Ÿ
}

// æŸ¥è¯¢ç¼“å­˜æ—¶ï¼ŒåªåŒ¹é…æ–‡ä»¶åå‰ç¼€
Future<String?> findCachedAudio(String word, String language) async {
  final cacheKey = getCacheKey(word);
  final cacheDir = Directory('$basePath/$language');

  if (!await cacheDir.exists()) return null;

  // æŸ¥æ‰¾ä»»æ„æ ¼å¼çš„ç¼“å­˜æ–‡ä»¶
  await for (final file in cacheDir.list()) {
    final fileName = path.basenameWithoutExtension(file.path);
    if (fileName == cacheKey) {
      return file.path;  // æ‰¾åˆ°ç¼“å­˜ï¼Œæ— è®ºæ ¼å¼
    }
  }
  return null;  // æœªå‘½ä¸­ç¼“å­˜
}
```

è¿™æ ·å³ä½¿ä» MP3 åˆ‡æ¢åˆ° WAVï¼Œç°æœ‰ç¼“å­˜ä»ç„¶æœ‰æ•ˆã€‚

### WordTtsService æ¥å£

```dart
abstract class WordTtsService {
  /// æ’­æ”¾å•è¯å‘éŸ³
  /// è‡ªåŠ¨é€‰æ‹©æœ€ä½³ç­–ç•¥ï¼ˆç¼“å­˜ â†’ æœ¬åœ° TTS â†’ äº‘ç«¯ TTSï¼‰
  Future<void> speakWord(String word, String language);

  /// é¢„åŠ è½½å•è¯åˆ—è¡¨ï¼ˆåå°ä¸‹è½½ï¼‰
  Future<void> preloadWords(List<String> words, String language);

  /// æ£€æŸ¥è¯­è¨€æ˜¯å¦æ”¯æŒæœ¬åœ° TTS
  Future<bool> isLocalTtsAvailable(String language);

  /// æ¸…é™¤ç¼“å­˜
  Future<void> clearCache({String? language});
}
```

---

## ğŸ“š ç›¸å…³èµ„æº

### MiniMax TTS

- [MiniMax API æ–‡æ¡£](https://www.minimax.chat/document/guides/T2A)
- [ç°æœ‰é›†æˆä»£ç ](../../backend/src/services/minimax.ts)
- [ç°æœ‰ TTS ç«¯ç‚¹](../../backend/src/server.ts) - `/tts/generate`

### Azure Speech TTS

- [Azure Speech TTS æ–‡æ¡£](https://learn.microsoft.com/azure/ai-services/speech-service/text-to-speech)
- [Azure æ”¯æŒçš„è¯­éŸ³åˆ—è¡¨](https://learn.microsoft.com/azure/ai-services/speech-service/language-support?tabs=tts)
- [Azure å®šä»·](https://azure.microsoft.com/en-us/pricing/details/speech/)

### å‰ç«¯

- [flutter_tts åŒ…](https://pub.dev/packages/flutter_tts)
- [å‘éŸ³åé¦ˆç»„ä»¶](../lib/features/chat/presentation/widgets/voice_feedback_sheet.dart)
